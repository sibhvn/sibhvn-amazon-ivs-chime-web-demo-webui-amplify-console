{"ast":null,"code":"\"use strict\"; // Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TRANSCRIPTION_DATA_MESSAGE_TOPIC = void 0;\n\nconst TranscriptEvent_1 = require(\"./TranscriptEvent\");\n\nexports.TRANSCRIPTION_DATA_MESSAGE_TOPIC = 'aws:chime:transcription';\n\nclass DefaultTranscriptionController {\n  constructor(realtimeController) {\n    this.realtimeController = realtimeController;\n    this.transcriptEventCallbacks = new Set();\n  }\n\n  subscribeToTranscriptEvent(callback) {\n    if (this.transcriptEventCallbacks.size === 0) {\n      this.realtimeController.realtimeSubscribeToReceiveDataMessage(exports.TRANSCRIPTION_DATA_MESSAGE_TOPIC, dataMessage => {\n        for (const transcriptEvent of TranscriptEvent_1.TranscriptEventConverter.from(dataMessage)) {\n          for (const transcriptEventCallback of this.transcriptEventCallbacks) {\n            transcriptEventCallback(transcriptEvent);\n          }\n        }\n      });\n    }\n\n    this.transcriptEventCallbacks.add(callback);\n  }\n\n  unsubscribeFromTranscriptEvent(callback) {\n    this.transcriptEventCallbacks.delete(callback);\n\n    if (this.transcriptEventCallbacks.size === 0) {\n      this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(exports.TRANSCRIPTION_DATA_MESSAGE_TOPIC);\n    }\n  }\n\n}\n\nexports.default = DefaultTranscriptionController;","map":{"version":3,"mappings":"cAAA;AACA;;;;;;;AAIA;;AAGaA,2CAAmC,yBAAnC;;AAEb,MAAqBC,8BAArB,CAAmD;EAGjDC,YAAoBC,kBAApB,EAA0D;IAAtC;IAClB,KAAKC,wBAAL,GAAgC,IAAIC,GAAJ,EAAhC;EACD;;EAEDC,0BAA0B,CAACC,QAAD,EAAqD;IAC7E,IAAI,KAAKH,wBAAL,CAA8BI,IAA9B,KAAuC,CAA3C,EAA8C;MAC5C,KAAKL,kBAAL,CAAwBM,qCAAxB,CACET,wCADF,EAEGU,WAAD,IAA6B;QAC3B,KAAK,MAAMC,eAAX,IAA8BC,2CAAyBC,IAAzB,CAA8BH,WAA9B,CAA9B,EAA0E;UACxE,KAAK,MAAMI,uBAAX,IAAsC,KAAKV,wBAA3C,EAAqE;YACnEU,uBAAuB,CAACH,eAAD,CAAvB;UACD;QACF;MACF,CARH;IAUD;;IAED,KAAKP,wBAAL,CAA8BW,GAA9B,CAAkCR,QAAlC;EACD;;EAEDS,8BAA8B,CAACT,QAAD,EAAqD;IACjF,KAAKH,wBAAL,CAA8Ba,MAA9B,CAAqCV,QAArC;;IAEA,IAAI,KAAKH,wBAAL,CAA8BI,IAA9B,KAAuC,CAA3C,EAA8C;MAC5C,KAAKL,kBAAL,CAAwBe,yCAAxB,CACElB,wCADF;IAGD;EACF;;AAhCgD;;AAAnDA","names":["exports","DefaultTranscriptionController","constructor","realtimeController","transcriptEventCallbacks","Set","subscribeToTranscriptEvent","callback","size","realtimeSubscribeToReceiveDataMessage","dataMessage","transcriptEvent","TranscriptEvent_1","from","transcriptEventCallback","add","unsubscribeFromTranscriptEvent","delete","realtimeUnsubscribeFromReceiveDataMessage"],"sourceRoot":"","sources":["../../src/transcript/DefaultTranscriptionController.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}