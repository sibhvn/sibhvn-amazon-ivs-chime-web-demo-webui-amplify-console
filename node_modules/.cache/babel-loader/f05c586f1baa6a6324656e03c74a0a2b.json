{"ast":null,"code":"\"use strict\"; // Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nclass ConnectionHealthData {\n  constructor() {\n    this.connectionStartTimestampMs = 0;\n    this.consecutiveStatsWithNoPackets = 0;\n    this.lastPacketLossInboundTimestampMs = 0;\n    this.lastGoodSignalTimestampMs = 0;\n    this.lastWeakSignalTimestampMs = 0;\n    this.lastNoSignalTimestampMs = 0;\n    this.consecutiveMissedPongs = 0;\n    this.packetsReceivedInLastMinute = [];\n    this.fractionPacketsLostInboundInLastMinute = [];\n    this.audioSpeakerDelayMs = 0;\n    this.connectionStartTimestampMs = Date.now();\n    this.lastGoodSignalTimestampMs = Date.now();\n  }\n\n  static isTimestampRecent(timestampMs, recentDurationMs) {\n    return Date.now() < timestampMs + recentDurationMs;\n  }\n\n  setConnectionStartTime() {\n    this.connectionStartTimestampMs = Date.now();\n    this.lastGoodSignalTimestampMs = Date.now();\n  }\n\n  reset() {\n    this.connectionStartTimestampMs = 0;\n    this.consecutiveStatsWithNoPackets = 0;\n    this.lastPacketLossInboundTimestampMs = 0;\n    this.lastGoodSignalTimestampMs = 0;\n    this.lastWeakSignalTimestampMs = 0;\n    this.lastNoSignalTimestampMs = 0;\n    this.consecutiveMissedPongs = 0;\n    this.packetsReceivedInLastMinute = [];\n    this.fractionPacketsLostInboundInLastMinute = [];\n    this.audioSpeakerDelayMs = 0;\n    this.connectionStartTimestampMs = Date.now();\n    this.lastGoodSignalTimestampMs = Date.now();\n  }\n\n  isConnectionStartRecent(recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.connectionStartTimestampMs, recentDurationMs);\n  }\n\n  isLastPacketLossRecent(recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastPacketLossInboundTimestampMs, recentDurationMs);\n  }\n\n  isGoodSignalRecent(recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastGoodSignalTimestampMs, recentDurationMs);\n  }\n\n  isWeakSignalRecent(recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastWeakSignalTimestampMs, recentDurationMs);\n  }\n\n  isNoSignalRecent(recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastNoSignalTimestampMs, recentDurationMs);\n  }\n\n  clone() {\n    const cloned = new ConnectionHealthData();\n    cloned.connectionStartTimestampMs = this.connectionStartTimestampMs;\n    cloned.consecutiveStatsWithNoPackets = this.consecutiveStatsWithNoPackets;\n    cloned.lastPacketLossInboundTimestampMs = this.lastPacketLossInboundTimestampMs;\n    cloned.lastGoodSignalTimestampMs = this.lastGoodSignalTimestampMs;\n    cloned.lastWeakSignalTimestampMs = this.lastWeakSignalTimestampMs;\n    cloned.lastNoSignalTimestampMs = this.lastNoSignalTimestampMs;\n    cloned.consecutiveMissedPongs = this.consecutiveMissedPongs;\n    cloned.packetsReceivedInLastMinute = this.packetsReceivedInLastMinute.slice(0);\n    cloned.fractionPacketsLostInboundInLastMinute = this.fractionPacketsLostInboundInLastMinute.slice(0);\n    cloned.audioSpeakerDelayMs = this.audioSpeakerDelayMs;\n    return cloned;\n  }\n\n  setConsecutiveMissedPongs(pongs) {\n    this.consecutiveMissedPongs = pongs;\n  }\n\n  setConsecutiveStatsWithNoPackets(stats) {\n    this.consecutiveStatsWithNoPackets = stats;\n  }\n\n  setLastPacketLossInboundTimestampMs(timeStamp) {\n    this.lastPacketLossInboundTimestampMs = timeStamp;\n  }\n\n  setLastNoSignalTimestampMs(timeStamp) {\n    this.lastNoSignalTimestampMs = timeStamp;\n  }\n\n  setLastWeakSignalTimestampMs(timeStamp) {\n    this.lastWeakSignalTimestampMs = timeStamp;\n  }\n\n  setLastGoodSignalTimestampMs(timeStamp) {\n    this.lastGoodSignalTimestampMs = timeStamp;\n  }\n\n  setAudioSpeakerDelayMs(delayMs) {\n    this.audioSpeakerDelayMs = delayMs;\n  }\n\n}\n\nexports.default = ConnectionHealthData;","map":{"version":3,"mappings":"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","names":["ConnectionHealthData","constructor","connectionStartTimestampMs","Date","now","lastGoodSignalTimestampMs","isTimestampRecent","timestampMs","recentDurationMs","setConnectionStartTime","reset","consecutiveStatsWithNoPackets","lastPacketLossInboundTimestampMs","lastWeakSignalTimestampMs","lastNoSignalTimestampMs","consecutiveMissedPongs","packetsReceivedInLastMinute","fractionPacketsLostInboundInLastMinute","audioSpeakerDelayMs","isConnectionStartRecent","isLastPacketLossRecent","isGoodSignalRecent","isWeakSignalRecent","isNoSignalRecent","clone","cloned","slice","setConsecutiveMissedPongs","pongs","setConsecutiveStatsWithNoPackets","stats","setLastPacketLossInboundTimestampMs","timeStamp","setLastNoSignalTimestampMs","setLastWeakSignalTimestampMs","setLastGoodSignalTimestampMs","setAudioSpeakerDelayMs","delayMs","exports"],"sourceRoot":"","sources":["../../src/connectionhealthpolicy/ConnectionHealthData.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}