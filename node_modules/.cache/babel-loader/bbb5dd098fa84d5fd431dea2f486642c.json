{"ast":null,"code":"\"use strict\"; // Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst DefaultBrowserBehavior_1 = require(\"../browserbehavior/DefaultBrowserBehavior\");\n\nconst TimeoutScheduler_1 = require(\"../scheduler/TimeoutScheduler\");\n\nconst SignalingProtocol_js_1 = require(\"../signalingprotocol/SignalingProtocol.js\");\n\nconst Versioning_1 = require(\"../versioning/Versioning\");\n\nconst WebSocketReadyState_1 = require(\"../websocketadapter/WebSocketReadyState\");\n\nconst SignalingClientEvent_1 = require(\"./SignalingClientEvent\");\n\nconst SignalingClientEventType_1 = require(\"./SignalingClientEventType\");\n/**\n * [[DefaultSignalingClient]] implements the SignalingClient interface.\n */\n\n\nclass DefaultSignalingClient {\n  constructor(webSocket, logger) {\n    this.webSocket = webSocket;\n    this.logger = logger;\n    this.unloadHandler = null;\n\n    this.closeEventHandler = event => {\n      this.deactivatePageUnloadHandler();\n      this.resetConnection();\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketClosed, null, event.code, event.reason));\n      this.serviceConnectionRequestQueue();\n    };\n\n    this.observerQueue = new Set();\n    this.connectionRequestQueue = [];\n    this.resetConnection();\n    this.logger.debug(() => 'signaling client init');\n    this.audioSessionId = this.generateNewAudioSessionId();\n  }\n\n  registerObserver(observer) {\n    this.logger.debug(() => 'registering signaling client observer');\n    this.observerQueue.add(observer);\n  }\n\n  removeObserver(observer) {\n    this.logger.debug(() => 'removing signaling client observer');\n    this.observerQueue.delete(observer);\n  }\n\n  openConnection(request) {\n    this.logger.info('adding connection request to queue: ' + request.url());\n    this.connectionRequestQueue.push(request);\n    this.closeConnection();\n  }\n\n  pingPong(pingPongFrame) {\n    this.logger.debug(() => 'sending ping');\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.PING_PONG;\n    message.pingPong = pingPongFrame;\n    this.sendMessage(message);\n    return message.timestampMs;\n  }\n\n  join(settings) {\n    this.logger.info('sending join');\n    const joinFrame = SignalingProtocol_js_1.SdkJoinFrame.create();\n    joinFrame.protocolVersion = 2;\n    joinFrame.flags = SignalingProtocol_js_1.SdkJoinFlags.HAS_STREAM_UPDATE;\n    const browserBehavior = new DefaultBrowserBehavior_1.default();\n\n    if (browserBehavior.supportsSenderSideBandwidthEstimation()) {\n      joinFrame.flags |= SignalingProtocol_js_1.SdkJoinFlags.USE_SEND_SIDE_BWE;\n    }\n\n    joinFrame.flags |= settings.sendBitrates ? SignalingProtocol_js_1.SdkJoinFlags.SEND_BITRATES : 0;\n    const sdkClientDetails = {\n      platformName: browserBehavior.name(),\n      platformVersion: browserBehavior.version(),\n      clientSource: Versioning_1.default.sdkName,\n      chimeSdkVersion: Versioning_1.default.sdkVersion\n    };\n\n    if (settings.applicationMetadata) {\n      const {\n        appName,\n        appVersion\n      } = settings.applicationMetadata;\n      sdkClientDetails.appName = appName;\n      sdkClientDetails.appVersion = appVersion;\n    }\n\n    joinFrame.clientDetails = SignalingProtocol_js_1.SdkClientDetails.create(sdkClientDetails);\n    joinFrame.audioSessionId = this.audioSessionId;\n    joinFrame.wantsCompressedSdp = DefaultSignalingClient.CLIENT_SUPPORTS_COMPRESSION;\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.JOIN;\n    message.join = joinFrame;\n    this.sendMessage(message);\n  }\n\n  subscribe(settings) {\n    const subscribeFrame = SignalingProtocol_js_1.SdkSubscribeFrame.create();\n    subscribeFrame.sendStreams = [];\n    subscribeFrame.sdpOffer = settings.sdpOffer;\n\n    if (settings.connectionTypeHasVideo) {\n      subscribeFrame.receiveStreamIds = settings.receiveStreamIds;\n    }\n\n    if (settings.audioHost) {\n      subscribeFrame.audioCheckin = settings.audioCheckin;\n      subscribeFrame.audioHost = settings.audioHost;\n      subscribeFrame.audioMuted = settings.audioMuted;\n\n      if (!settings.audioCheckin) {\n        const audioStream = SignalingProtocol_js_1.SdkStreamDescriptor.create();\n        audioStream.mediaType = SignalingProtocol_js_1.SdkStreamMediaType.AUDIO;\n        audioStream.trackLabel = 'AmazonChimeExpressAudio';\n        audioStream.attendeeId = settings.attendeeId;\n        audioStream.streamId = 1;\n        audioStream.groupId = 1;\n        audioStream.framerate = 15;\n        audioStream.maxBitrateKbps = 600;\n        audioStream.avgBitrateBps = 400000;\n        subscribeFrame.sendStreams.push(audioStream);\n      }\n    }\n\n    subscribeFrame.compressedSdpOffer = settings.compressedSdpOffer;\n    subscribeFrame.duplex = SignalingProtocol_js_1.SdkStreamServiceType.RX;\n\n    if (settings.localVideoEnabled) {\n      subscribeFrame.duplex = SignalingProtocol_js_1.SdkStreamServiceType.DUPLEX;\n\n      for (let i = 0; i < settings.videoStreamDescriptions.length; i++) {\n        // Non-simulcast use DefaultVideoStreamIndex.localStreamDescriptions\n        // which is the exact old behavior\n        const streamDescription = settings.videoStreamDescriptions[i].clone();\n        streamDescription.attendeeId = settings.attendeeId;\n        subscribeFrame.sendStreams.push(streamDescription.toStreamDescriptor());\n      }\n    }\n\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.SUBSCRIBE;\n    message.sub = subscribeFrame;\n    this.sendMessage(message);\n  }\n\n  remoteVideoUpdate(addedOrUpdated, removed) {\n    const remoteVideoUpdate = SignalingProtocol_js_1.SdkRemoteVideoUpdateFrame.create();\n    remoteVideoUpdate.addedOrUpdatedVideoSubscriptions = addedOrUpdated.map(this.convertVideoSubscriptionConfiguration);\n    remoteVideoUpdate.removedVideoSubscriptionMids = removed;\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.REMOTE_VIDEO_UPDATE;\n    message.remoteVideoUpdate = remoteVideoUpdate;\n    this.sendMessage(message);\n  }\n\n  convertVideoSubscriptionConfiguration(config) {\n    const signalConfig = new SignalingProtocol_js_1.SdkVideoSubscriptionConfiguration();\n    signalConfig.mid = config.mid;\n    signalConfig.attendeeId = config.attendeeId;\n    signalConfig.streamId = config.streamId;\n    return signalConfig;\n  }\n\n  leave() {\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.LEAVE;\n    message.leave = SignalingProtocol_js_1.SdkLeaveFrame.create();\n    this.sendMessage(message);\n    this.logger.debug(() => {\n      return 'sent leave';\n    });\n  }\n\n  sendClientMetrics(clientMetricFrame) {\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.CLIENT_METRIC;\n    message.clientMetric = clientMetricFrame;\n    this.sendMessage(message);\n  }\n\n  sendDataMessage(messageFrame) {\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.DATA_MESSAGE;\n    message.dataMessage = messageFrame;\n    this.sendMessage(message);\n  }\n\n  closeConnection() {\n    var _a, _b;\n\n    if (this.webSocket.readyState() !== WebSocketReadyState_1.default.None && this.webSocket.readyState() !== WebSocketReadyState_1.default.Closed) {\n      this.isClosing = true;\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketClosing, null)); // Continue resetting the connection even if SDK does not receive the \"close\" event.\n\n      const scheduler = new TimeoutScheduler_1.default(DefaultSignalingClient.CLOSE_EVENT_TIMEOUT_MS);\n\n      const handler = event => {\n        var _a, _b;\n        /* istanbul ignore next */\n\n\n        (_b = (_a = this.webSocket).removeEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'close', handler);\n        scheduler.stop();\n        this.closeEventHandler(event);\n      }; // Remove the existing close handler to prevent SDK from opening a new connection.\n\n      /* istanbul ignore next */\n\n\n      (_b = (_a = this.webSocket).removeEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'close', this.closeEventHandler);\n      this.webSocket.addEventListener('close', handler);\n      scheduler.start(() => {\n        // SDK has not received the \"close\" event on WebSocket for two seconds.\n        // Handle a fake close event with 1006 to indicate that the client abnormally closed the connection.\n        handler(new CloseEvent('close', {\n          wasClean: false,\n          code: 1006,\n          reason: '',\n          bubbles: false\n        }));\n      });\n      this.webSocket.close();\n      this.deactivatePageUnloadHandler();\n    } else {\n      this.logger.info('no existing signaling client connection needs closing');\n      this.serviceConnectionRequestQueue();\n    }\n  }\n\n  ready() {\n    return this.webSocket.readyState() === WebSocketReadyState_1.default.Open && !this.isClosing && this.wasOpened;\n  }\n\n  mute(muted) {\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.AUDIO_CONTROL;\n    const audioControl = SignalingProtocol_js_1.SdkAudioControlFrame.create();\n    audioControl.muted = muted;\n    message.audioControl = audioControl;\n    this.sendMessage(message);\n  }\n\n  pause(streamIds) {\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.PAUSE;\n    message.pause = SignalingProtocol_js_1.SdkPauseResumeFrame.create();\n    message.pause.streamIds = streamIds;\n    this.sendMessage(message);\n  }\n\n  resume(streamIds) {\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.RESUME;\n    message.pause = SignalingProtocol_js_1.SdkPauseResumeFrame.create();\n    message.pause.streamIds = streamIds;\n    this.sendMessage(message);\n  }\n\n  resetConnection() {\n    this.webSocket.destroy();\n    this.wasOpened = false;\n  }\n\n  sendMessage(message) {\n    message.timestampMs = Date.now();\n    this.logger.debug(() => `sending: ${JSON.stringify(message)}`);\n    const buffer = this.prependWithFrameTypeRTC(SignalingProtocol_js_1.SdkSignalFrame.encode(message).finish());\n\n    if (this.ready()) {\n      if (!this.webSocket.send(buffer)) {\n        this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketSendMessageFailure, null));\n        return;\n      }\n\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketSentMessage, null));\n    } else {\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketSkippedMessage, null));\n    }\n  }\n\n  receiveMessage(inBuffer) {\n    let message;\n\n    try {\n      message = SignalingProtocol_js_1.SdkSignalFrame.decode(inBuffer);\n    } catch (e) {\n      this.logger.info(`failed to decode: ${inBuffer}`);\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.ProtocolDecodeFailure, null));\n      return;\n    }\n\n    this.logger.debug(() => `received: ${JSON.stringify(message)}`);\n\n    if (this.webSocket.readyState() === WebSocketReadyState_1.default.Open) {\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.ReceivedSignalFrame, message));\n    } else {\n      this.logger.info(`skipping notification of message since WebSocket is not open: ${JSON.stringify(message)}`);\n    }\n  }\n\n  stripFrameTypeRTC(inBuffer) {\n    const frameType = inBuffer[0]; // TODO: change server frame type to send 0x05\n\n    if (frameType !== DefaultSignalingClient.FRAME_TYPE_RTC && frameType !== 0x02) {\n      this.logger.warn(`expected FrameTypeRTC for message but got ${frameType}`);\n    }\n\n    return inBuffer.slice(1);\n  }\n\n  prependWithFrameTypeRTC(inBuffer) {\n    const outBuffer = new Uint8Array(inBuffer.length + 1);\n    outBuffer[0] = DefaultSignalingClient.FRAME_TYPE_RTC;\n    outBuffer.set(inBuffer, 1);\n    return outBuffer;\n  }\n\n  serviceConnectionRequestQueue() {\n    if (this.connectionRequestQueue.length === 0) {\n      this.logger.info('no connection requests to service');\n      return;\n    }\n\n    const request = this.connectionRequestQueue.shift();\n    this.logger.info(`opening connection to ${request.url()}`);\n    this.isClosing = false;\n    this.webSocket.create(request.url(), request.protocols());\n    this.setUpEventListeners();\n    this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketConnecting, null));\n  }\n\n  sendEvent(event) {\n    switch (event.type) {\n      case SignalingClientEventType_1.default.WebSocketMessage:\n      case SignalingClientEventType_1.default.ReceivedSignalFrame:\n      case SignalingClientEventType_1.default.WebSocketSentMessage:\n        this.logger.debug(() => `notifying event: ${SignalingClientEventType_1.default[event.type]}`);\n        break;\n\n      case SignalingClientEventType_1.default.WebSocketSkippedMessage:\n        this.logger.debug(() => `notifying event: ${SignalingClientEventType_1.default[event.type]}, websocket state=${WebSocketReadyState_1.default[this.webSocket.readyState()]}`);\n        break;\n\n      default:\n        this.logger.info(`notifying event: ${SignalingClientEventType_1.default[event.type]}`);\n        break;\n    }\n\n    for (const observer of this.observerQueue) {\n      observer.handleSignalingClientEvent(event);\n    }\n  }\n\n  setUpEventListeners() {\n    this.webSocket.addEventListener('open', () => {\n      this.activatePageUnloadHandler();\n      this.wasOpened = true;\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketOpen, null));\n    });\n    this.webSocket.addEventListener('message', event => {\n      this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketMessage, null));\n      this.receiveMessage(this.stripFrameTypeRTC(new Uint8Array(event.data)));\n    });\n    this.webSocket.addEventListener('close', this.closeEventHandler);\n    this.webSocket.addEventListener('error', () => {\n      if (this.isClosing && !this.wasOpened) {\n        this.logger.info('ignoring error closing signaling while connecting');\n        return;\n      }\n\n      if (this.wasOpened) {\n        this.logger.error('received error while connected');\n        this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketError, null));\n      } else {\n        this.logger.error('failed to connect');\n        this.sendEvent(new SignalingClientEvent_1.default(this, SignalingClientEventType_1.default.WebSocketFailed, null));\n      }\n    });\n  }\n\n  activatePageUnloadHandler() {\n    this.unloadHandler = () => {\n      this.leave();\n    }; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n    const GlobalAny = global;\n    GlobalAny['window'] && GlobalAny['window']['addEventListener'] && window.addEventListener('unload', this.unloadHandler);\n  }\n\n  deactivatePageUnloadHandler() {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const GlobalAny = global;\n    GlobalAny['window'] && GlobalAny['window']['addEventListener'] && window.removeEventListener('unload', this.unloadHandler);\n    this.unloadHandler = null;\n  }\n\n  generateNewAudioSessionId() {\n    const num = new Uint32Array(1);\n    const randomNum = window.crypto.getRandomValues(num);\n    return randomNum[0];\n  }\n\n  promoteToPrimaryMeeting(credentials) {\n    const signaledCredentials = SignalingProtocol_js_1.SdkMeetingSessionCredentials.create();\n    signaledCredentials.attendeeId = credentials.attendeeId;\n    signaledCredentials.externalUserId = credentials.externalUserId;\n    signaledCredentials.joinToken = credentials.joinToken;\n    const primaryMeetingJoin = SignalingProtocol_js_1.SdkPrimaryMeetingJoinFrame.create();\n    primaryMeetingJoin.credentials = signaledCredentials;\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN;\n    message.primaryMeetingJoin = primaryMeetingJoin;\n    this.sendMessage(message);\n  }\n\n  demoteFromPrimaryMeeting() {\n    const primaryMeetingLeave = SignalingProtocol_js_1.SdkPrimaryMeetingLeaveFrame.create();\n    const message = SignalingProtocol_js_1.SdkSignalFrame.create();\n    message.type = SignalingProtocol_js_1.SdkSignalFrame.Type.PRIMARY_MEETING_LEAVE;\n    message.primaryMeetingLeave = primaryMeetingLeave;\n    this.sendMessage(message);\n  }\n\n}\n\nexports.default = DefaultSignalingClient;\nDefaultSignalingClient.FRAME_TYPE_RTC = 0x5;\nDefaultSignalingClient.CLOSE_EVENT_TIMEOUT_MS = 2000;\nDefaultSignalingClient.CLIENT_SUPPORTS_COMPRESSION = true;","map":{"version":3,"mappings":"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","names":["DefaultSignalingClient","constructor","webSocket","logger","event","deactivatePageUnloadHandler","resetConnection","sendEvent","SignalingClientEvent_1","SignalingClientEventType_1","WebSocketClosed","code","reason","serviceConnectionRequestQueue","observerQueue","Set","connectionRequestQueue","debug","audioSessionId","generateNewAudioSessionId","registerObserver","observer","add","removeObserver","delete","openConnection","request","info","url","push","closeConnection","pingPong","pingPongFrame","message","SignalingProtocol_js_1","create","type","Type","PING_PONG","sendMessage","timestampMs","join","settings","joinFrame","protocolVersion","flags","HAS_STREAM_UPDATE","browserBehavior","DefaultBrowserBehavior_1","supportsSenderSideBandwidthEstimation","USE_SEND_SIDE_BWE","sendBitrates","SEND_BITRATES","sdkClientDetails","platformName","name","platformVersion","version","clientSource","Versioning_1","sdkName","chimeSdkVersion","sdkVersion","applicationMetadata","appName","appVersion","clientDetails","wantsCompressedSdp","CLIENT_SUPPORTS_COMPRESSION","JOIN","subscribe","subscribeFrame","sendStreams","sdpOffer","connectionTypeHasVideo","receiveStreamIds","audioHost","audioCheckin","audioMuted","audioStream","mediaType","AUDIO","trackLabel","attendeeId","streamId","groupId","framerate","maxBitrateKbps","avgBitrateBps","compressedSdpOffer","duplex","RX","localVideoEnabled","DUPLEX","i","videoStreamDescriptions","length","streamDescription","clone","toStreamDescriptor","SUBSCRIBE","sub","remoteVideoUpdate","addedOrUpdated","removed","addedOrUpdatedVideoSubscriptions","map","convertVideoSubscriptionConfiguration","removedVideoSubscriptionMids","REMOTE_VIDEO_UPDATE","config","signalConfig","mid","leave","LEAVE","sendClientMetrics","clientMetricFrame","CLIENT_METRIC","clientMetric","sendDataMessage","messageFrame","DATA_MESSAGE","dataMessage","readyState","WebSocketReadyState_1","None","Closed","isClosing","WebSocketClosing","scheduler","TimeoutScheduler_1","CLOSE_EVENT_TIMEOUT_MS","handler","removeEventListener","_b","stop","closeEventHandler","addEventListener","start","CloseEvent","wasClean","bubbles","close","ready","Open","wasOpened","mute","muted","AUDIO_CONTROL","audioControl","pause","streamIds","PAUSE","resume","RESUME","destroy","Date","now","JSON","stringify","buffer","prependWithFrameTypeRTC","encode","finish","send","WebSocketSendMessageFailure","WebSocketSentMessage","WebSocketSkippedMessage","receiveMessage","inBuffer","decode","e","ProtocolDecodeFailure","ReceivedSignalFrame","stripFrameTypeRTC","frameType","FRAME_TYPE_RTC","warn","slice","outBuffer","Uint8Array","set","shift","protocols","setUpEventListeners","WebSocketConnecting","WebSocketMessage","handleSignalingClientEvent","activatePageUnloadHandler","WebSocketOpen","data","error","WebSocketError","WebSocketFailed","unloadHandler","GlobalAny","global","window","num","Uint32Array","randomNum","crypto","getRandomValues","promoteToPrimaryMeeting","credentials","signaledCredentials","externalUserId","joinToken","primaryMeetingJoin","PRIMARY_MEETING_JOIN","demoteFromPrimaryMeeting","primaryMeetingLeave","PRIMARY_MEETING_LEAVE","exports"],"sourceRoot":"","sources":["../../src/signalingclient/DefaultSignalingClient.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}